load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")

go_library(
    name = "go_default_library",
    srcs = [
        "monitoring.go",
        "operation.go",
        "operation_config.go",
        "operation_fetch.go",
        "operation_install.go",
        "operation_remove.go",
        "operation_retryable.go",
        "operation_start.go",
        "operation_stop.go",
        "operation_uninstall.go",
        "operation_verify.go",
        "operator.go",
        "operator_handlers.go",
    ],
    importpath = "github.com/elastic/beats/v7/x-pack/elastic-agent/pkg/agent/operation",
    visibility = ["//visibility:public"],
    deps = [
        "//x-pack/elastic-agent/pkg/agent/application/paths:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/configrequest:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/configuration:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/errors:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/program:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/stateresolver:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/download:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/install:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/uninstall:go_default_library",
        "//x-pack/elastic-agent/pkg/core/app:go_default_library",
        "//x-pack/elastic-agent/pkg/core/logger:go_default_library",
        "//x-pack/elastic-agent/pkg/core/monitoring:go_default_library",
        "//x-pack/elastic-agent/pkg/core/plugin/process:go_default_library",
        "//x-pack/elastic-agent/pkg/core/plugin/service:go_default_library",
        "//x-pack/elastic-agent/pkg/core/retry:go_default_library",
        "//x-pack/elastic-agent/pkg/core/server:go_default_library",
        "//x-pack/elastic-agent/pkg/core/state:go_default_library",
        "//x-pack/elastic-agent/pkg/release:go_default_library",
        "@com_github_elastic_elastic_agent_client_v7//pkg/proto:go_default_library",
        "@com_github_hashicorp_go_multierror//:go_default_library",
    ],
)

go_test(
    name = "go_default_test",
    srcs = [
        "common_test.go",
        "monitoring_test.go",
        "operator_test.go",
    ],
    embed = [":go_default_library"],
    deps = [
        "//libbeat/logp:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/configrequest:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/configuration:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/program:go_default_library",
        "//x-pack/elastic-agent/pkg/agent/stateresolver:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/download:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/install:go_default_library",
        "//x-pack/elastic-agent/pkg/artifact/uninstall:go_default_library",
        "//x-pack/elastic-agent/pkg/config:go_default_library",
        "//x-pack/elastic-agent/pkg/core/app:go_default_library",
        "//x-pack/elastic-agent/pkg/core/logger:go_default_library",
        "//x-pack/elastic-agent/pkg/core/monitoring:go_default_library",
        "//x-pack/elastic-agent/pkg/core/monitoring/config:go_default_library",
        "//x-pack/elastic-agent/pkg/core/monitoring/noop:go_default_library",
        "//x-pack/elastic-agent/pkg/core/process:go_default_library",
        "//x-pack/elastic-agent/pkg/core/retry:go_default_library",
        "//x-pack/elastic-agent/pkg/core/server:go_default_library",
        "//x-pack/elastic-agent/pkg/core/state:go_default_library",
        "@com_github_elastic_elastic_agent_client_v7//pkg/proto:go_default_library",
        "@com_github_stretchr_testify//assert:go_default_library",
    ],
)
